# axis limits
xlim(0,1.25)+
ylim(0,2.5)+
# add boundary lines for Van Krevelen regions
geom_segment(x = 0.0, y = 1.5, xend = 1.2, yend = 1.5,color="black",linetype="longdash")+
geom_segment(x = 0.0, y = 2, xend = 1.2, yend = 2,color="black",linetype="longdash")+
geom_segment(x = 0.0, y = 1, xend = 1.2, yend = 0.75,color="black",linetype="longdash")+
geom_segment(x = 0.0, y = 0.7, xend = 1.2, yend = 0.5,color="black",linetype="longdash")
}
gg_vankrev(sorbed[sorbed$adsorbed=="sorbed",], aes(x = OC, y = HC, color=fenton))+
# scale_color_manual(values = c("#F1A340","#998EC3"))+
scale_color_manual(values = c("grey40","darkblue"))+
facet_wrap(~fenton)+
theme_kp()+
theme(legend.position = "none")
# create a custom ggplot function for Van Krevelen plots
gg_vankrev <- function(data,mapping){
ggplot(data,mapping)+
# plot points
geom_point(size=2.5, alpha = 0.4, stroke = 1)+ # set size and transparency
# axis labels
ylab("H/C")+
xlab("O/C")+
# axis limits
xlim(0,1.25)+
ylim(0,2.5)+
# add boundary lines for Van Krevelen regions
geom_segment(x = 0.0, y = 1.5, xend = 1.2, yend = 1.5,color="black",linetype="longdash")+
geom_segment(x = 0.0, y = 2, xend = 1.2, yend = 2,color="black",linetype="longdash")+
geom_segment(x = 0.0, y = 1, xend = 1.2, yend = 0.75,color="black",linetype="longdash")+
geom_segment(x = 0.0, y = 0.7, xend = 1.2, yend = 0.5,color="black",linetype="longdash")
}
gg_vankrev(sorbed[sorbed$adsorbed=="sorbed",], aes(x = OC, y = HC, color=fenton))+
# scale_color_manual(values = c("#F1A340","#998EC3"))+
scale_color_manual(values = c("grey40","darkblue"))+
facet_wrap(~fenton)+
theme_kp()+
theme(legend.position = "none")
gg_vankrev(fentonloss2[fentonloss2$loss=="lost"|fentonloss2$loss=="gained",],
aes(x = OC, y = HC, color = loss, shape=loss))+
scale_shape_manual(values = c(16,1))+
scale_color_brewer(palette = "Dark2")+
theme_kp()+
guides(colour = guide_legend(override.aes = list(alpha = 1)))
gg_vankrev(sorbed[sorbed$adsorbed=="sorbed",], aes(x = OC, y = HC, color=fenton))+
# scale_color_manual(values = c("#F1A340","#998EC3"))+
scale_color_manual(values = c("grey40","darkblue"))+
facet_wrap(~fenton)+
theme_kp()+
theme(legend.position = "none")
g = 1 #weight of goethite used, units = g
mL = 30 # volume of solution used, mL
conc = read_excel("data/doc_concentrations.xlsx", sheet = "DOC conc") %>%
dplyr::rename(doc_mg_L = `DOC blank corrected, mg/L`) %>%
select(Sample_no, Forest, Fenton, Goethite, doc_mg_L) %>%
na.omit() %>%
spread(Goethite,doc_mg_L) %>%
dplyr::mutate(adsorbed_mg_L = PreGoethite-PostGoethite,
adsorbed_mg_g = adsorbed_mg_L*(1/1000)*(mL/g))
ggplot(conc, aes(x = Forest, y = adsorbed_mg_g, color = Fenton))+
geom_point()
View(conc)
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(doc_mg_L = mean(PreGoethite),
doc_se = stdev(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = stdev(adsorbed_mg_g)/sqrt(n()))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
View(conc_summary)
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = sd(PreGoethite)/sqrt(n()))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(adsorbed_se2 = sd(adsorbed_mg_g),
doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(adsorbed_se2 = sd(adsorbed_mg_g),
doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se3 = sd(adsorbed_mg_g))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(adsorbed_se2 = sd(adsorbed_mg_g)/sqrt(n()),
doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se3 = sd(adsorbed_mg_g))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(adsorbed_se2 = sd(adsorbed_mg_g)/sqrt(n()),
doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()),
doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(
doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(
doc_mg_L = mean(PreGoethite),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n())
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(
doc_mg_L = mean(PreGoethite),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(
doc_mg_L = mean(PreGoethite),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()),
adsorbed_mg_g = mean(adsorbed_mg_g),
doc_se = sd(PreGoethite)/sqrt(n()))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(adsorbed_mg_g = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()),
doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()))
conc_summary =
conc %>%
group_by(Forest, Fenton) %>%
dplyr::summarise(doc_mg_L = mean(PreGoethite),
doc_se = sd(PreGoethite)/sqrt(n()),
adsorbed_mgg = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
source("4-doc_conc.R")
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,2),"",round(doc_se,2)))
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,2),"",round(doc_se,2))) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,0),"",round(doc_se,2))) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,0),"",round(doc_se,1))) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,0),"U00B1",round(doc_se,1))) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,0),\U00B1,round(doc_se,1))) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,0),"\U00B1",round(doc_se,1))) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,0),"\U00B1",round(doc_se,1))) %>%
dplyr::select(Forest, Fenton, wsoc_mg_L) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(adsorbed = paste(round(adsorbed_mgg,1),"\U00B1",round(adsorbed_se,1))) %>%
dplyr::select(Forest, Fenton, adsorbed) %>%
knitr::kable(align = "r")
conc_summary %>%
group_by(Fenton) %>%
dplyr::mutate(adsorbed = paste(round(adsorbed_mgg,1),"\U00B1",round(adsorbed_se,1))) %>%
dplyr::select(Fenton, adsorbed) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(adsorbed = paste(round(adsorbed_mgg,1),"\U00B1",round(adsorbed_se,1))) %>%
dplyr::select(Forest, Fenton, adsorbed) %>%
knitr::kable(align = "r")
conc_summary %>%
dplyr::mutate(wsoc_mg_L = paste(round(doc_mg_L,0),"\U00B1",round(doc_se,1))) %>%
dplyr::select(Forest, Fenton, wsoc_mg_L) %>%
knitr::kable(align = "r")
m = lm(doc_mg_L~Fenton*Forest, data = conc)
m = lm(PreGoethite~Fenton*Forest, data = conc)
View(m)
m
aov(m)
anova(m)
m1 = lm(PreGoethite~Fenton, data = conc[conc$Forest=="HW"])
m1 = lm(PreGoethite~Fenton, data = conc[conc$Forest=="HW",])
m2 = lm(PreGoethite~Fenton, data = conc[conc$Forest=="SW",])
anova(m1)
anova(m2)
master2 %>%
group_by(Mass,Treatment, Class) %>%
dplyr::summarise(O = mean(O)) %>%
ungroup %>%
group_by(Treatment, Class) %>%
dplyr::summarise(medianO = median(O)) %>%
spread(Treatment, medianO)
View(loss_summary2)
View(fentonloss)
View(fentonloss2)
View(fentonloss)
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n())
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
na.omit()
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
replace_na("")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
mutate_all(na_if,"")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
mutate_all(na_if,"") %>%
knitr::kable(align = "r")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
replace_na("") %>%
knitr::kable(align = "r")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
na_if(.,"") %>%
knitr::kable(align = "r")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
na_if(.,"") %>%
na.omit() %>%
knitr::kable(align = "r")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
na_if(.,"") %>%
na.omit() %>%
dplyr::mutate(var = paste(Forest,loss)) %>%
dplyr::select(var, Class, count) %>%
knitr::kable(align = "r")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
na_if(.,"") %>%
na.omit() %>%
dplyr::mutate(var = paste(Forest,loss)) %>%
select(var, Class, count) %>%
knitr::kable(align = "r")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
na_if(.,"") %>%
na.omit() %>%
dplyr::mutate(var = paste(Forest,loss)) %>%
ungroup %>%
select(var, Class, count) %>%
knitr::kable(align = "r")
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
na_if(.,"") %>%
na.omit() %>%
dplyr::mutate(var = paste(Forest,loss)) %>%
ungroup %>%
select(var, Class, count) %>%
spread(var, count) %>%
knitr::kable(align = "r")
anova(m1)
anova(m2)
## step 4. statistics
## 4.1. effect of Fenton reaction on DOC concentration
library(nlme)
View(conc)
m1 = lme(PreGoethite~Fenton, random = ~Sample_no, data = conc[conc$Forest=="HW",])
m1 = lme(PreGoethite~Fenton, random = ~1|Sample_no, data = conc[conc$Forest=="HW",])
anova(m1)
m2 = lme(PreGoethite~Fenton, random = ~1|Sample_no, data = conc[conc$Forest=="SW",])
anova(m1)
anova(m2)
View(sorbed_relabund)
View(conc)
conc %>%
dplyr::summarize(adsorbed_mean = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
conc %>%
group_by(Forest) %>%
dplyr::summarize(adsorbed_mean = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
conc %>%
group_by(Fenton) %>%
dplyr::summarize(adsorbed_mean = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
conc %>%
dplyr::summarize(adsorbed_mean = mean(adsorbed_mg_g),
adsorbed_se = sd(adsorbed_mg_g)/sqrt(n()))
View(fentonloss)
View(sorbed)
View(sorbed_relabund)
View(fentonloss)
View(fentonloss2)
View(sorbed)
sorbed = read.csv(GOETHITE_ADSORPTION)
View(sorbed)
combined =
fentonloss %>%
left_join(sorbed, by = c("Mass","Forest"))
View(combined)
View(fentonloss)
combined =
fentonloss %>%
left_join(select(sorbed,-HC,-OC) by = c("Mass","Forest"))
combined =
fentonloss %>%
left_join(select(sorbed,-HC,-OC), by = c("Mass","Forest"))
combined =
fentonloss %>%
left_join(select(sorbed,-HC,-OC), by = c("Mass","Forest")) %>%
group_by(Mass,loss,adsorbed, HC,OC,O,Class) %>%
dplyr::summarise(n= n())
combined =
fentonloss %>%
left_join(select(sorbed,-HC,-OC), by = c("Mass","Forest")) %>%
group_by(Mass,loss,adsorbed, HC,OC,O,Class) %>%
dplyr::summarise(n= n()) %>%
na_if(.,"")
ggplot(combined, aes(x = O, color = adsorbed))+
geom_histogram()
ggplot(combined, aes(x = O, color = adsorbed))+
geom_histogram()+
facet_wrap(~loss)
ggplot(combined, aes(x = O, color = adsorbed))+
geom_histogram(alpha = 0.2, position = "identity")+
facet_wrap(~loss)
ggplot(combined, aes(x = O, color = adsorbed, fill = adsorbed))+
geom_histogram(alpha = 0.2, position = "identity")+
facet_wrap(~loss)
ggplot(combined, aes(x = O, color = adsorbed, fill = adsorbed))+
geom_histogram(alpha = 0.2, position = "identity", binwidth=1)+
facet_wrap(~loss)
ggplot(combined, aes(x = O, color = adsorbed, fill = adsorbed))+
geom_histogram(alpha = 0.2, position = "identity", binwidth=1)+
facet_grid(Class~loss)
ggplot(combined[combined$adsorbed=="sorbed",], aes(x = O, color = adsorbed, fill = adsorbed))+
geom_histogram(alpha = 0.2, position = "identity", binwidth=1)+
facet_grid(Class~loss)
ggplot(combined[combined$adsorbed=="unbound",], aes(x = O, color = adsorbed, fill = adsorbed))+
geom_histogram(alpha = 0.2, position = "identity", binwidth=1)+
facet_grid(Class~loss)
combined %>%
group_by(loss) %>%
dplyr::summarise(total_peaks = n())
combined %>%
group_by(loss, adsorbed) %>%
dplyr::summarise(total = n())
combined %>%
group_by(loss, adsorbed) %>%
dplyr::summarise(total = n()) %>%
spread(adsorbed, total)
combined %>%
group_by(loss) %>%
dplyr::summarise(total_peaks = n())
combined %>%
group_by(loss, adsorbed) %>%
dplyr::summarise(total = n()) %>%
spread(adsorbed, total)
combined %>%
group_by(loss) %>%
filter(!adsorbed=="new") %>%
dplyr::summarise(total_peaks = n())
combined %>%
group_by(loss, adsorbed) %>%
dplyr::summarise(total = n()) %>%
spread(adsorbed, total)
master %>%
group_by(Forest, Treatment) %>%
dplyr::summarise(peaks = n()) %>%
knitr::kable(align = "r")
master2 %>%
group_by(Mass,Treatment, Class) %>%
dplyr::summarise(O = mean(O)) %>%
ungroup %>%
group_by(Treatment, Class) %>%
dplyr::summarise(medianO = median(O)) %>%
spread(Treatment, medianO)
fentonloss %>%
left_join(class, by = "Mass") %>%
group_by(Forest, loss, Class) %>%
dplyr::summarize(count = n()) %>%
na_if(.,"") %>%
na.omit() %>%
dplyr::mutate(var = paste(Forest,loss)) %>%
ungroup %>%
select(var, Class, count) %>%
spread(var, count) %>%
knitr::kable(align = "r")
fentonloss %>%
group_by(Mass,loss) %>%
dplyr::summarise(n = n()) %>%
fentonloss %>%
group_by(Mass,loss) %>%
dplyr::summarise(n = n())
fentonloss %>%
group_by(Mass,loss) %>%
dplyr::summarise(n = n()) %>%
na_if(.,"") %>%
na.omit() %>%
left_join(class, by = "Mass")
fentonloss %>%
group_by(Mass,loss) %>%
dplyr::summarise(n = n()) %>%
na_if(.,"") %>%
na.omit() %>%
left_join(class, by = "Mass") %>%
group_by(loss, Class) %>%
dplyr::summarize(count = n()) %>%
ungroup %>%
select(loss Class, count) %>%
spread(loss, count) %>%
knitr::kable(align = "r")
fentonloss %>%
group_by(Mass,loss) %>%
dplyr::summarise(n = n()) %>%
na_if(.,"") %>%
na.omit() %>%
left_join(class, by = "Mass") %>%
group_by(loss, Class) %>%
dplyr::summarize(count = n()) %>%
ungroup %>%
select(loss, Class, count) %>%
spread(loss, count) %>%
knitr::kable(align = "r")
combined %>%
group_by(loss, adsorbed) %>%
dplyr::summarise(total = n()) %>%
spread(adsorbed, total)
combined %>%
group_by(loss) %>%
filter(!adsorbed=="new") %>%
dplyr::summarise(total_peaks = n())
combined %>%
group_by(loss, adsorbed) %>%
dplyr::summarise(total = n()) %>%
spread(adsorbed, total)
