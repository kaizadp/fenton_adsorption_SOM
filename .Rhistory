!is.na(SatFatAcCarb) ~ SatFatAcCarb,
!is.na(`UnSatAlip.N`) ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom) ~ PolyCyArom,
!is.na(Aromatic) ~ Aromatic,
!is.na(HighUnsatLign) ~ HighUnsatLign,
!is.na(UnSatAliph_noN) ~ UnSatAliph_noN,
!is.na(SatFatAcCarb) ~ SatFatAcCarb,
!is.na(`UnSatAlip.N`) ~ `UnSatAlip.N`,
TRUE ~ NA_real_))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom) ~ PolyCyArom,
!is.na(Aromatic) ~ Aromatic,
!is.na(HighUnsatLign) ~ HighUnsatLign,
!is.na(UnSatAliph_noN) ~ UnSatAliph_noN,
!is.na(SatFatAcCarb) ~ SatFatAcCarb,
!is.na(`UnSatAlip.N`) ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom,
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom,
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ "PolyCyArom",
Aromatic=="Aromatic" ~ "Aromatic",
HighUnsatLign=="HUnSatLig" ~ "HighUnsatLign",
UnSatAliph_noN=="AlipatNoN" ~ "UnSatAliph_noN",
SatFatAcCarb=="SatFACarb" ~ "SatFatAcCarb",
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom,
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ "PolyCyArom",
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
View(RAW_DATA_LONG)
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ "a",
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom,
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom,
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
dplyr::mutate(Class2 = case_when(Aromatic=="Aromatic" ~ Aromatic) ->
dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom)) %>%
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom)) %>%
dplyr::mutate(Class2 = case_when(Aromatic=="Aromatic" ~ Aromatic)) ->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom,
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom,
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr" ~ PolyCyArom,
Aromatic=="Aromatic" ~ Aromatic,
HighUnsatLign=="HUnSatLig" ~ HighUnsatLign,
UnSatAliph_noN=="AlipatNoN" ~ UnSatAliph_noN,
SatFatAcCarb=="SatFACarb" ~ SatFatAcCarb,
`UnSatAlip.N`=="Alipat+N" ~ `UnSatAlip.N`))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = if_else(PolyCyArom=="CondAr","PolyCyArom",
if_else(Aromatic=="Aromatic", "Aromatic",
if_else(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
if_else(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
if_else(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
if_else(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N", NA)))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = ifelse(PolyCyArom=="CondAr","PolyCyArom",
ifelse(Aromatic=="Aromatic", "Aromatic",
ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N", NA)))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = ifelse(PolyCyArom=="CondAr","PolyCyArom",
ifelse(Aromatic=="Aromatic", "Aromatic",
ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
"NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = ifelse(PolyCyArom=="CondAr","CondAr",
ifelse(Aromatic=="Aromatic", "Aromatic",
ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
"NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
dplyr::mutate(Class2 = ifelse(PolyCyArom=="CondAr","Cond",
ifelse(Aromatic=="Aromatic", "Ar",
ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
"NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = ifelse(PolyCyArom=="CondAr","CondAr",
ifelse(Aromatic=="Aromatic", "Aromatic",
ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
"NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~PolyCyArom,
is.na(PolyCyArom)&!is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~Aromatic))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~PolyCyArom,
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~Aromatic))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"PolyCyArom",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="")~"SatFatAcCarb"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)&(UnSatAlip.N=="Alipat+N	")~"Alipat+N"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class2 = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)&(UnSatAlip.N=="Alipat+N")~"Alipat+N"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
#  mutate(Class = paste(PolyCyArom,Aromatic,HighUnsatLign,UnSatAliph_noN,SatFatAcCarb,UnSatAlip.N))->
RAW_DATA_LONG
RAW_DATA2 %>%
gather(soil, intensity, starts_with("Soil_")) %>%
na.omit()->
RAW_DATA_LONG
RAW_DATA_LONG = merge(RAW_DATA_LONG, soil_key, by = "soil")
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)&(UnSatAlip.N=="Alipat+N")~"Alipat+N"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
RAW_DATA_LONG
names(RAW_DATA_LONG)
RAW_DATA_LONG %>%
select(-PolyCyArom,-Aromatic,-HighUnsatLign,-UnSatAliph_noN,-SatFatAcCarb,-UnSatAlip.N)->
RAW_DATA_LONG
write.csv(RAW_DATA_LONG,FTICR_RAWMASTER_LONG)
rawmaster = read.csv(FTICR_RAWMASTER_LONG)# <- "fticr/fticr_rawmaster_long.csv"
master %>%
filter(treatment=="PreFenton") %>%
filter(intensity>0) %>%
group_by(Mass, Forest,Class) %>%
dplyr::summarise(intensity = mean(intensity)) %>%
ungroup %>%
group_by(Forest,Class) %>%
dplyr::summarize(peaks = n())->
counts_m
rawmaster %>%
filter(Treatment=="PreFenton") %>%
filter(intensity>0) %>%
group_by(Mass, Forest,Class) %>%
dplyr::summarise(intensity = mean(intensity)) %>%
ungroup %>%
group_by(Forest,Class) %>%
dplyr::summarize(peaks = n())->
counts
View(counts)
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)&(UnSatAlip.N=="Alipat+N")~"Aliphat+N"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)&(UnSatAlip.N=="Alipat+N")~"Aliphat+N"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
RAW_DATA_LONG
RAW_DATA2 %>%
gather(soil, intensity, starts_with("Soil_")) %>%
na.omit()->
RAW_DATA_LONG
RAW_DATA_LONG = merge(RAW_DATA_LONG, soil_key, by = "soil")
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)&(UnSatAlip.N=="Alipat+N")~"Aliphat+N"))->
# dplyr::mutate(Class2 = case_when(PolyCyArom=="CondAr","CondAr",
# ifelse(Aromatic=="Aromatic", "Aromatic",
# ifelse(HighUnsatLign=="HUnSatLig", "HighUnsatLign",
# ifelse(UnSatAliph_noN=="AlipatNoN",  "UnSatAliph_noN",
# ifelse(SatFatAcCarb=="SatFACarb", "SatFatAcCarb",
# ifelse(`UnSatAlip.N`=="Alipat+N", "UnSatAlip.N",
#       "NA")))))))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
select(-PolyCyArom,-Aromatic,-HighUnsatLign,-UnSatAliph_noN,-SatFatAcCarb,-UnSatAlip.N)->
RAW_DATA_LONG
write.csv(RAW_DATA_LONG,FTICR_RAWMASTER_LONG)
master = read.csv(FTICR_MASTER_LONG)# <- "fticr/fticr_master_long.csv" #
rawmaster %>%
filter(Treatment=="PreFenton") %>%
filter(intensity>0) %>%
group_by(Mass, Forest,Class) %>%
dplyr::summarise(intensity = mean(intensity)) %>%
ungroup %>%
group_by(Forest,Class) %>%
dplyr::summarize(peaks = n())->
counts
View(counts)
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)&(UnSatAlip.N=="Alipat+N")~"Aliphat+N"))->
RAW_DATA_LONG
RAW_DATA2 %>%
gather(soil, intensity, starts_with("Soil_")) %>%
na.omit()->
RAW_DATA_LONG
RAW_DATA_LONG = merge(RAW_DATA_LONG, soil_key, by = "soil")
RAW_DATA_LONG %>%
na_if(.,"----") %>%
mutate(Class = case_when(!is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"CondAr",
is.na(PolyCyArom)&(Aromatic=="Aromatic")&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"Aromatic",
is.na(PolyCyArom)&is.na(Aromatic)&(HighUnsatLign=="HUnSatLig")&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)~"HighUnsatLign",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&(UnSatAliph_noN=="AlipatNoN")&is.na(SatFatAcCarb)~"UnSatAliph_noN",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&(SatFatAcCarb=="SatFACarb")~"SatFatAcCarb",
is.na(PolyCyArom)&is.na(Aromatic)&is.na(HighUnsatLign)&is.na(UnSatAliph_noN)&is.na(SatFatAcCarb)&(UnSatAlip.N=="Alipat+N")~"Aliphat+N"))->
RAW_DATA_LONG
RAW_DATA_LONG %>%
select(-PolyCyArom,-Aromatic,-HighUnsatLign,-UnSatAliph_noN,-SatFatAcCarb,-UnSatAlip.N)->
RAW_DATA_LONG
write.csv(RAW_DATA_LONG,FTICR_RAWMASTER_LONG)
rawmaster = read.csv(FTICR_RAWMASTER_LONG)# <- "fticr/fticr_rawmaster_long.csv"
# summarizing by groups
rawmaster %>%
mutate(intensity = as.numeric(intensity)) %>% # set intensity as a numeric variable
filter(Goethite == "PreGoethite") %>% # keep only pre-Goethite data. we don't want post-adsorption data
group_by(Forest,Fenton,soil,Class) %>%
dplyr::summarize(compounds = sum(as.numeric(intensity), na.rm = TRUE)) %>% # this gives total intensity for each group
# in the same command, we will also create a column for total intensity
ungroup() %>% # remove the previous grouping
group_by(soil) %>% # create a new grouping
dplyr::mutate(total = sum(compounds)) %>%  # add a column for total intensity
# we can also calculate the relative abundance in the same command
mutate(relabund = (compounds/total)*100) %>% # calculate relative abundance as a %
mutate(relabund = round(relabund,2))-> # round to two decimal places
raw_coregroups
rawmaster %>%
filter(Treatment=="PreFenton") %>%
filter(intensity>0) %>%
group_by(Mass, Forest,Class) %>%
dplyr::summarise(intensity = mean(intensity)) %>%
ungroup %>%
group_by(Forest,Class) %>%
dplyr::summarize(peaks = n())->
counts
master %>%
filter(treatment=="PreFenton") %>%
filter(intensity>0) %>%
group_by(Mass, Forest) %>%
dplyr::summarise(intensity = mean(intensity)) %>%
ungroup %>%
group_by(Forest) %>%
dplyr::summarize(peaks = n())->
counts_m
View(counts_m)
