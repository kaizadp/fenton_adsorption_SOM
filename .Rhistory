geom_histogram()+
geom_histogram(aes(data = fenton_el[fenton_el$loss=="lost",], x = O))+
scale_y_reverse()
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram((data = fenton_el[fenton_el$loss=="lost",], x = O))+
scale_y_reverse()
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram((data = fenton_el[fenton_el$loss=="lost",]))+
scale_y_reverse()
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram((data = fenton_el[fenton_el$loss=="lost",]))
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram((data = fenton_el[fenton_el$loss=="lost",], color = "red"))
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram((data = fenton_el, color = "red"))
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram(data = fenton_el, color = "red")
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram(data = fenton_el[fenton_el$loss=="lost",], color = "red")
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram(data = fenton_el[fenton_el$loss=="lost",], color = "red")+
scale_y_reverse()
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram(data = fenton_el[fenton_el$loss=="lost",], color = "red",scale_y_reverse())
geom_histogram(data = fenton_el[fenton_el$loss=="lost",], color = "red",scale_y_reverse
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
geom_histogram(data = fenton_el[fenton_el$loss=="lost",], color = "red",scale_y_reverse)
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
scale_y_reverse(geom_histogram(data = fenton_el[fenton_el$loss=="lost",], color = "red"))
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
(geom_histogram(data = fenton_el[fenton_el$loss=="lost",], color = "red"))
ggplot(fenton_el[fenton_el$loss=="gained",], aes(x = (O), fill = loss))+
geom_histogram()+
(geom_histogram(data = fenton_el[fenton_el$loss=="lost",]))
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss = "lost",counts*-1,counts))->
loss_summary2
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss = "lost",(counts*(-1)),counts))->
loss_summary2
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "lost",(counts*(-1)),counts))->
loss_summary2
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "gained",counts,-1*counts))->
loss_summary2
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) ->temp
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts))->temp
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts))%>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "gained",counts,-1*counts))->
loss_summary2
ggplot(fenton_el[!fenton_el$loss=="conserved",], aes(O, counts, fill = loss))+
geom_bar()
ggplot(fenton_el[!fenton_el$loss=="conserved",], aes(x=O, y=counts, fill = loss))+
geom_bar(stat = "identity", alpha=0.6)
ggplot(fenton_el[!fenton_el$loss=="conserved",], aes(x=as.factor(O), y=counts, fill = loss))+
geom_bar(stat = "identity", alpha=0.6)
ggplot(fenton_el[!fenton_el$loss=="conserved",], aes(x=as.factor(O), y=counts, fill = loss))+
geom_bar(stat = "identity", alpha=0.6)+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))
ggplot(fenton_el[!fenton_el$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_bar(stat = "identity", alpha=0.6)+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_bar(stat = "identity", alpha=0.6)+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
geom_segment(x = 13.5, y = 0, xend = 13.5, yend = 7.5,color="black",linetype="longdash")+
geom_segment(x = 10.5, y = 0, xend = 10.5, yend = -7.5,color="black",linetype="longdash")+
annotate("text", label = "median 13.5", x = 13.5, y = 7.8)+
annotate("text", label = "median 10.5", x = 10.5, y = -7.8)+
theme_bw()+
theme_kp()
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
geom_segment(x = 14, y = 0, xend = 14, yend = 150,color="black",linetype="longdash")+
geom_segment(x = 10, y = 0, xend = 10, yend = -200,color="black",linetype="longdash")+
annotate("text", label = "median 13.5", x = 13.5, y = 7.8)+
annotate("text", label = "median 10.5", x = 10.5, y = -7.8)+
theme_bw()+
theme_kp()
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
geom_segment(x = 14, y = 0, xend = 14, yend = 150,color="black",linetype="longdash")+
geom_segment(x = 10, y = 0, xend = 10, yend = -200,color="black",linetype="longdash")+
annotate("text", label = "median 14", x = 14, y = 150)+
annotate("text", label = "median 10", x = 10, y = -200)+
theme_bw()+
theme_kp()
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 14, y = 0, xend = 14, yend = 150,color="black",linetype="longdash")+
geom_segment(x = 10, y = 0, xend = 10, yend = -200,color="black",linetype="longdash")+
annotate("text", label = "median 14", x = 14, y = 150)+
annotate("text", label = "median 10", x = 10, y = -200)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_bw()+
theme_kp()
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 14, y = 0, xend = 14, yend = 145,color="black",linetype="longdash")+
geom_segment(x = 10, y = 0, xend = 10, yend = -170,color="black",linetype="longdash")+
annotate("text", label = "median 14", x = 14, y = 150)+
annotate("text", label = "median 10", x = 10, y = -180)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_bw()+
theme_kp()
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 14, y = 0, xend = 14, yend = 140,color="black",linetype="longdash")+
geom_segment(x = 10, y = 0, xend = 10, yend = -180,color="black",linetype="longdash")+
annotate("text", label = "median 14", x = 14, y = 150)+
annotate("text", label = "median 10", x = 10, y = -190)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_bw()+
theme_kp()
fenton_el = merge(fentonloss, meta_elements, by = "Mass", all.x=TRUE)
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts))%>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "gained",counts,-1*counts))->
loss_summary2
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 14, y = 0, xend = 14, yend = 140,color="black",linetype="longdash")+
geom_segment(x = 10, y = 0, xend = 10, yend = -180,color="black",linetype="longdash")+
annotate("text", label = "median 14", x = 14, y = 150)+
annotate("text", label = "median 10", x = 10, y = -190)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_kp()
sorbed
View(sorbed)
names(sorbed)
# INPUT
meta_elements = read.csv(ELEMENTS)
sorbed %>%
select(Mass, Forest, sorption_frac) %>%
left_join(select(meta_elements, Mass, O), by = "Mass")->sorbed_el
View(sorbed_el)
sorbed %>%
select(Mass, Forest, sorption_frac) %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) ->sorbed_el
sorbed %>%
select(Mass, Forest, sorption_frac) %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) ->sorbed_el
sorbed %>%
select(Mass, Forest, sorption_frac) %>%
left_join(select(fenton,meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) ->sorbed_el
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) ->sorbed_el
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup %>%
group_by(fenton,sorption_frac,O) %>%
dplyr::summarise(counts = n())->sorbed_el
ggplot(sorbed_el, x = O, y = counts, fill = sorption_frac)+
geom_bar(stat = "identity")
ggplot(sorbed_el, aes(x = O, y = counts, fill = sorption_frac))+
geom_bar(stat = "identity")
ggplot(sorbed_el, aes(x = O, y = counts, fill = sorption_frac))+
geom_bar(stat = "identity")+
facet_wrap(~sorption_frac)
ggplot(sorbed_el, aes(x = O, y = counts, fill = sorption_frac))+
geom_bar(stat = "identity")+
facet_grid(sorption_frac~fenton)
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup %>%
group_by(fenton,sorption_frac,O) %>%
dplyr::summarise(counts = n()) %>%
dplyr::mutate(counts2 = if_else(sorption_frac=="most unbound",counts,-1*counts))->sorbed_el
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup %>%
group_by(fenton,sorption_frac,O) %>%
dplyr::summarise(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts),
counts2 = if_else(sorption_frac=="most unbound",counts,-1*counts))->sorbed_el
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup %>%
group_by(fenton,sorption_frac,O) %>%
dplyr::summarise(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts),
counts2 = if_else(sorption_frac=="most unbound",counts,-1*counts)) %>%
ungroup() %>%
group_by(fenton,sorption_frac) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum))->sorbed_el
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
filter(sorption_frac=="most sorbed" | sorption_frac=="most unbound") %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup %>%
group_by(fenton,sorption_frac,O) %>%
dplyr::summarise(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts),
counts2 = if_else(sorption_frac=="most unbound",counts,-1*counts)) %>%
ungroup() %>%
group_by(fenton,sorption_frac) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum))->sorbed_el
ggplot(sorbed_el, aes(x = O, y = counts, fill = sorption_frac))+
geom_bar(stat = "identity")+
facet_grid(sorption_frac~fenton)
ggplot(sorbed_el, aes(x = O, y = counts2, fill = sorption_frac))+
geom_bar(stat = "identity")+
facet_wrap(~fenton)
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
filter(sorption_frac=="most sorbed" | sorption_frac=="most unbound") %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup %>%
group_by(fenton,sorption_frac,O) %>%
dplyr::summarise(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts),
counts2 = if_else(sorption_frac=="most unbound",counts,-1*counts)) %>%
ungroup() %>%
group_by(fenton,sorption_frac) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
mean = mean(cumsum))->sorbed_el
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
filter(sorption_frac=="most sorbed" | sorption_frac=="most unbound") %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup %>%
group_by(fenton,sorption_frac,O) %>%
dplyr::summarise(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts),
counts2 = if_else(sorption_frac=="most unbound",counts,-1*counts)) %>%
ungroup() %>%
group_by(fenton,sorption_frac) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(counts))->sorbed_el
View(fenton_el)
View(loss_summary2)
fenton_el = merge(fentonloss, meta_elements, by = "Mass", all.x=TRUE)
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts))%>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "gained",counts,-1*counts))->
loss_summary2
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 13, y = 0, xend = 13, yend = 140,color="black",linetype="longdash")+
geom_segment(x = 7, y = 0, xend = 7, yend = -180,color="black",linetype="longdash")+
annotate("text", label = "median 14", x = 13, y = 150)+
annotate("text", label = "median 7", x = 7, y = -190)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_kp()
fenton_el = merge(fentonloss, meta_elements, by = "Mass", all.x=TRUE)
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts))%>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "gained",counts,-1*counts))->
loss_summary2
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 13.5, y = 0, xend = 13.5, yend = 140,color="black",linetype="longdash")+
geom_segment(x = 7.5, y = 0, xend = 7.5, yend = -180,color="black",linetype="longdash")+
annotate("text", label = "median 14", x = 13, y = 150)+
annotate("text", label = "median 7", x = 7, y = -190)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_kp()
fenton_el = merge(fentonloss, meta_elements, by = "Mass", all.x=TRUE)
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts))%>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "gained",counts,-1*counts))->
loss_summary2
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 13.5, y = 0, xend = 13.5, yend = 140,color="black",linetype="longdash")+
geom_segment(x = 8.5, y = 0, xend = 8.5, yend = -180,color="black",linetype="longdash")+
annotate("text", label = "median 13", x = 13.5, y = 150)+
annotate("text", label = "median 8", x = 8.5, y = -200)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_kp()
fenton_el = merge(fentonloss, meta_elements, by = "Mass", all.x=TRUE)
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts))%>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "gained",counts,-1*counts))->
loss_summary2
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 13.5, y = 0, xend = 13.5, yend = 140,color="black",linetype="longdash")+
geom_segment(x = 8.5, y = 0, xend = 8.5, yend = -195,color="black",linetype="longdash")+
annotate("text", label = "median 13", x = 13.5, y = 150)+
annotate("text", label = "median 8", x = 8.5, y = -200)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_kp()
fenton_el = merge(fentonloss, meta_elements, by = "Mass", all.x=TRUE)
fenton_el %>%
group_by(loss,O) %>%
dplyr::summarize(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts))%>%
ungroup() %>%
group_by(loss) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(cumsum),
counts2 = if_else(loss == "gained",counts,-1*counts))->
loss_summary2
ggplot(loss_summary2[!loss_summary2$loss=="conserved",], aes(x=as.factor(O), y=counts2, fill = loss))+
geom_segment(x = 13.5, y = 0, xend = 13.5, yend = 140,color="black",linetype="longdash")+
geom_segment(x = 8.5, y = 0, xend = 8.5, yend = -190,color="black",linetype="longdash")+
annotate("text", label = "median 13", x = 13.5, y = 150)+
annotate("text", label = "median 8", x = 8.5, y = -200)+
geom_bar(stat = "identity", alpha=0.6)+
scale_fill_brewer(palette="Dark2")+
scale_x_discrete(breaks = c("0", "5","10","15","20","25","30"))+
ylab("number of peaks")+
xlab("number of O")+
theme_kp()
sorbed %>%
select(Mass, Forest, sorption_frac, fenton) %>%
filter(sorption_frac=="most sorbed" | sorption_frac=="most unbound") %>%
left_join(select(meta_elements, Mass, O), by = "Mass") %>%
group_by(fenton,sorption_frac,Mass,O) %>%
dplyr::summarize(counts = n()) %>%
ungroup %>%
group_by(fenton,sorption_frac,O) %>%
dplyr::summarise(counts = n()) %>%
dplyr::mutate(counts = as.numeric(counts),
counts2 = if_else(sorption_frac=="most unbound",counts,-1*counts)) %>%
ungroup() %>%
group_by(fenton,sorption_frac) %>%
dplyr::mutate(cumsum = cumsum(counts),
median = median(counts))->sorbed_el
ggplot(sorbed_el, aes(x = O, y = counts2, fill = sorption_frac))+
geom_bar(stat = "identity")+
facet_wrap(~fenton)
View(goethite)
source("0-packages.R")
# INPUT
meta_elements = read.csv(ELEMENTS)
hcoc = read.csv(HCOC)
relabund = read.csv(RELATIVE_ABUND)# <- "fticr/fticr_relative_abundance.csv"
elements = read.csv(SUMMARY_ELEMENTS)# <- "fticr/fticr_summary_elements.csv"
percentile = read.csv(PERCENTILE)
fentonloss = read.csv(FENTON_LOSS)
sorbed = read.csv(GOETHITE_ADSORPTION)
sorbed_relabund = read.csv(GOETHITE_RELABUND)
goethite %>%
dplyr::mutate(adsorbed = case_when(!is.na(PreGoethite)&is.na(PostGoethite)~"sorbed",
is.na(PreGoethite)&!is.na(PostGoethite)~"unbound"))->
goethite
View(sorbed)
View(sorbed_relabund)
sorbed %>%
dplyr::mutate(adsorbed = case_when(PreGoethite>0 &PostGoethite==0~"sorbed",
PreGoethite==0&PostGoethite>0~"unbound"))->goethite_temp
View(goethite_temp)
names(goethite_temp)
sorbed %>%
dplyr::mutate(adsorbed = case_when(PreGoethite>0 &PostGoethite==0~"sorbed",
PreGoethite==0&PostGoethite>0~"unbound")) %>%
dplyr::select(Mass,Forest,fenton,sorption_frac,adsorbed, HC,OC)->goethite_temp
gg_vankrev(sorbed, aes(x = OC, y=HC, color = adsorbed))+
facet_wrap(~fenton)
gg_vankrev(goethite_temp, aes(x = OC, y=HC, color = adsorbed))+
facet_wrap(~fenton)
gg_vankrev(goethite_temp[!is.na(goethite_temp$adsorbed),], aes(x = OC, y=HC, color = adsorbed))+
facet_wrap(~fenton)
gg_vankrev(goethite_temp, aes(x = OC, y=HC, color = adsorbed))+
facet_wrap(~fenton)
gg_vankrev(goethite_temp[!is.na(goethite_temp$adsorbed),], aes(x = OC, y=HC, color = adsorbed))+
facet_wrap(~fenton)
sorbed %>%
dplyr::mutate(adsorbed = case_when(PreGoethite>0 &PostGoethite==0~"sorbed",
PreGoethite>0&PostGoethite>0~"unbound")) %>%
dplyr::select(Mass,Forest,fenton,sorption_frac,adsorbed, HC,OC)->goethite_temp
gg_vankrev(goethite_temp[!is.na(goethite_temp$adsorbed),], aes(x = OC, y=HC, color = adsorbed))+
facet_wrap(~fenton)
