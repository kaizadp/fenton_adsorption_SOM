mutate(NOSC = 4 - (((4*C) + H - (3*N) - (2*O) - (2*S))/C)) %>%
dplyr::rename(HC = H.C) %>%
dplyr:: rename(OC = O.C)->
fticr_meta
# create a smaller meta file for only HC OC
fticr_meta %>%
select(Mass, HC, OC) ->
fticr_meta_hcoc
# create a subset of META for only relevant columns
fticr_meta %>%
select(Mass, HC, OC,
NOSC,
Class,
KM_CH2, KMD_CH2,
AI_0)->
fticr_meta_subset
# create a subset with only Mass and Class
fticr_meta %>%
select(Mass, Class)->
fticr_meta_class
# create a subset with only Mass and elements
fticr_meta %>%
select(Mass:Na)->
fticr_meta_elements
# SAVE META FILES
write_csv(fticr_meta, path = "fticr/fticr_meta.csv")
write_csv(fticr_meta_hcoc, path = "fticr/fticr_meta_hcoc.csv")
write_csv(fticr_meta_subset, path = "fticr/fticr_meta_subset.csv")
fticr_data = read_excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
# subset only "Mass" and sample columns
fticr_data %>%
select("Mass",starts_with("Pre"), starts_with("Post")) %>%
dplyr::rename(PostFentonGoethiteSW = `Post FentonGoethiteSW`) %>%
dplyr::rename(PostFentonSW = `Post FentonSW`) %>%
mutate(Mass = paste(round(Mass,4)))->
fticr_data
fticr_data %>%
select(Mass,ends_with("HW"))->
fticr_data_hw
fticr_data %>%
select(Mass,ends_with("SW"))->
fticr_data_sw
fticr_data_hw %>%
mutate(Forest = "HW") %>%
dplyr::rename(PreFenton = PreFentonHW) %>%
dplyr::rename(PreFentonGoethite = PreFentonGoethiteHW) %>%
dplyr::rename(PostFenton = PostFentonHW) %>%
dplyr::rename(PostFentonGoethite = PostFentonGoethiteHW) ->
fticr_data_hw
fticr_data_sw %>%
mutate(Forest = "SW") %>%
dplyr::rename(PreFenton = PreFentonSW) %>%
dplyr::rename(PreFentonGoethite = PreFentonGoethiteSW) %>%
dplyr::rename(PostFenton = PostFentonSW) %>%
dplyr::rename(PostFentonGoethite = PostFentonGoethiteSW) ->
fticr_data_sw
# then, combine both files
## This is now the MASTER DATA file
fticr_data_2 = rbind(fticr_data_hw,fticr_data_sw)
## OUTPUT
write_csv(fticr_data_2, path = "fticr/fticr_data_master.csv")
fticr_data_3 = fticr_data_2 %>%
gather(treatment, intensity, PreFenton:PostFentonGoethite)
## OUTPUT
write_csv(fticr_data_3, path = "fticr/fticr_data_master_longform.csv")
### 1.2.2 raw files ----
soil_key = read_csv("data/soil_key.csv")
hw_pref = read_csv("data/hw_prefenton.csv")
hw_postf = read_csv("data/hw_postfenton.csv")
sw_pref = read_csv("data/sw_prefenton.csv")
sw_postf = read_csv("data/sw_postfenton.csv")
fticr_data_raw = merge(hw_pref, hw_postf, by = "mass")
fticr_data_raw = merge(fticr_data_raw, sw_pref, by = "mass")
fticr_data_raw = merge(fticr_data_raw, sw_postf, by = "mass")
names(fticr_data_raw)
# rename all the f-ing columns
fticr_data_raw %>%
dplyr::rename(Mass = mass) %>%
mutate(Mass = paste(round(Mass,4))) %>% # round the mass to four decimals
dplyr::rename(Soil_1 = PreHW1.csv) %>%
dplyr::rename(Soil_2 = PreHW2.csv) %>%
dplyr::rename(Soil_3 = PreHW3.csv) %>%
dplyr::rename(Soil_4 = PreSW4.csv) %>%
dplyr::rename(Soil_5 = PreSW5.csv) %>%
dplyr::rename(Soil_6 = PreSW6.csv) %>%
dplyr::rename(Soil_7 = PosFHW1.csv) %>%
dplyr::rename(Soil_8 = PosFHW2.csv) %>%
dplyr::rename(Soil_9 = PosFHW3.csv) %>%
dplyr::rename(Soil_10 = PosSW10.csv) %>%
dplyr::rename(Soil_11 = PosSW11.csv) %>%
dplyr::rename(Soil_12 = PosSW12.csv) %>%
dplyr::rename(Soil_13 = PreHWGt13.csv) %>%
dplyr::rename(Soil_14 = PreHWGt14.csv) %>%
dplyr::rename(Soil_15 = PreHWGt15.csv) %>%
dplyr::rename(Soil_16 = PreSWGt16.csv) %>%
dplyr::rename(Soil_17 = PreSWGt17.csv) %>%
dplyr::rename(Soil_18 = PreSWGt18.csv) %>%
dplyr::rename(Soil_19 = `PosFHW-Gt1.csv`) %>%
dplyr::rename(Soil_20 = `PosFHW-Gt2.csv`) %>%
dplyr::rename(Soil_21 = `PosFHW-Gt3.csv`) %>%
dplyr::rename(Soil_22 = PosSW22.csv) %>%
dplyr::rename(Soil_23 = PosSW23.csv) %>%
dplyr::rename(Soil_24 = PosSW24.csv) ->
fticr_data_raw
# merge with meta_class
fticr_data_raw2 = merge(fticr_meta_class,fticr_data_raw,by = "Mass", all.y = T)
fticr_data_raw2 = fticr_data_raw2[complete.cases(fticr_data_raw2),]
write_csv(fticr_data_raw, path = "fticr/fticr_data_raw.csv")
fticr_data_raw2 %>%
gather(soil, intensity, Soil_1:Soil_24)->
fticr_data_raw_long
fticr_data_raw_long = merge(soil_key,fticr_data_raw_long)
write_csv(fticr_data_raw_long, path = "fticr/fticr_data_raw_long.csv")
# select only the relevant columns. don't include the Goethite columns
fticr_data_2 %>%
select(Mass, Forest, PreFenton, PostFenton)->
fticr_data_fenton
# create new column for molecules gained/lost during the Fenton reaction
setDT(fticr_data_fenton)[PreFenton >0 & PostFenton == 0, loss := "lost"]
fticr_data_fenton[PreFenton == 0 & PostFenton > 0, loss := "gained"]
fticr_data_fenton[PreFenton > 0 & PostFenton > 0, loss := "conserved"]
fticr_data_fenton$loss = ordered(fticr_data_fenton$loss, levels = c("lost", "gained", "conserved"))
## OUTPUT
write_csv(fticr_data_fenton,path = "fticr/fticr_data_fenton.csv")
fticr_data_fenton = read.csv("fticr/fticr_data_fenton.csv")
fticr_data_goethite = read.csv("fticr/fticr_data_goethite.csv")
fticr_data_2 = read.csv("fticr/fticr_data_master.csv")
fticr_meta_subset = read.csv("fticr/fticr_meta_subset.csv")
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = join(fticr_data_fenton, fticr_meta_subset,by = "Mass", type = "left", match = "all")
View(fticr_data_fenton3)
fticr_data_fenton = read.csv("fticr/fticr_data_fenton.csv",
col_types = cols(
Mass = col_number(),
Forest = col_factor(),
PreFenton = col_number(),
PostFenton = col_number(),
loss = col_factor()))
fticr_data_fenton = read_csv("fticr/fticr_data_fenton.csv",
col_types = cols(
Mass = col_number(),
Forest = col_factor(),
PreFenton = col_number(),
PostFenton = col_number(),
loss = col_factor()))
str(fticr_data_fenton)
fticr_meta_subset = read_csv("fticr/fticr_meta_subset.csv",
col_types = cols(
Mass = col_number()
))
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = join(fticr_data_fenton, fticr_meta_subset,by = "Mass", type = "left", match = "all")
View(fticr_data_fenton3)
str(fticr_meta_subset)
fticr_meta_subset = read_csv("fticr/fticr_meta_subset.csv",
col_types = cols(
Mass = col_number(),
HC = col_number(),
OC = col_number(),
NOSC = col_number(),
Class = col_factor(),
KM_CH2 = col_number(),
KMD_CH2 = col_number(),
AI_0 = col_number()
))
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = join(fticr_data_fenton, fticr_meta_subset,by = "Mass", type = "left", match = "all")
View(fticr_data_fenton3)
# create a subset of META for only relevant columns
fticr_meta %>%
select(Mass, HC, OC,
NOSC,
Class,
KM_CH2, KMD_CH2,
AI_0)->
fticr_meta_subset
# select only the relevant columns. don't include the Goethite columns
fticr_data_2 %>%
select(Mass, Forest, PreFenton, PostFenton)->
fticr_data_fenton
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = join(fticr_data_fenton, fticr_meta_subset,by = "Mass", type = "left", match = "all")
View(fticr_data_fenton3)
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = merge(fticr_data_fenton, fticr_meta_subset,by = "Mass")
View(fticr_data_fenton3)
fticr_data_fenton2 = cbind(fticr_data_fenton, fticr_meta_subset)
View(fticr_data_2)
View(fticr_data_fenton2)
# create a subset of META for only relevant columns
fticr_meta %>%
select(Mass, HC, OC,
NOSC,
Class,
KM_CH2, KMD_CH2,
AI_0)->
fticr_meta_subset
fticr_meta_subset$Mass
fticr_meta_subset %>%
mutate(Mass = paste(round(Mass,4)))->
fticr_meta_subset
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read_excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
# remove sample data columns. All sample names are Pre-xxx or Post-xxx
# remove unnamed columns 39-40-41
fticr_meta %>%
select(-starts_with("Pre")) %>%
select(-starts_with("Post")) %>%
select(-c("...39","...40","...41")) %>%
select(-c("C13", "Candidates","outlier")) %>%
mutate(Mass = paste(round(Mass,4)))-> # round this to 4 decimal places
fticr_meta
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read_excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
# remove sample data columns. All sample names are Pre-xxx or Post-xxx
# remove unnamed columns 39-40-41
fticr_meta %>%
select(-starts_with("Pre")) %>%
select(-starts_with("Post")) %>%
select(-c("...39","...40","...41")) %>%
select(-c("C13", "Candidates","outlier")) -> # round this to 4 decimal places
fticr_meta
fticr_meta$Mass = round(fticr_meta$Mass,4)
# create a subset of META for only relevant columns
fticr_meta %>%
select(Mass, HC, OC,
NOSC,
Class,
KM_CH2, KMD_CH2,
AI_0)->
fticr_meta_subset
# create a new column for NOSC
fticr_meta %>%
mutate(NOSC = 4 - (((4*C) + H - (3*N) - (2*O) - (2*S))/C)) %>%
dplyr::rename(HC = H.C) %>%
dplyr:: rename(OC = O.C)->
fticr_meta
# create a smaller meta file for only HC OC
fticr_meta %>%
select(Mass, HC, OC) ->
fticr_meta_hcoc
# create a subset of META for only relevant columns
fticr_meta %>%
select(Mass, HC, OC,
NOSC,
Class,
KM_CH2, KMD_CH2,
AI_0)->
fticr_meta_subset
View(fticr_meta_subset)
fticr_meta_subset %>%
mutate(Mass = paste(round(Mass,4)))->
fticr_meta_subset
# remove sample data columns. All sample names are Pre-xxx or Post-xxx
# remove unnamed columns 39-40-41
fticr_meta %>%
select(-starts_with("Pre")) %>%
select(-starts_with("Post")) %>%
select(-c("...39","...40","...41")) %>%
select(-c("C13", "Candidates","outlier")) -> # round this to 4 decimal places
fticr_meta
fticr_meta$Mass = round(fticr_meta$Mass,4)
# create a new column for NOSC
fticr_meta %>%
mutate(NOSC = 4 - (((4*C) + H - (3*N) - (2*O) - (2*S))/C)) %>%
dplyr::rename(HC = H.C) %>%
dplyr:: rename(OC = O.C)->
fticr_meta
fticr_meta_subset$Mass = as.numeric(fticr_meta_subset$Mass)
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = merge(fticr_data_fenton, fticr_meta_subset,by = "Mass")
View(fticr_data_fenton3)
# remove sample data columns. All sample names are Pre-xxx or Post-xxx
# remove unnamed columns 39-40-41
fticr_meta %>%
select(-starts_with("Pre")) %>%
select(-starts_with("Post")) %>%
select(-c("...39","...40","...41")) %>%
select(-c("C13", "Candidates","outlier")) %>%
mutate(Mass = round(Mass,4))-> # round this to 4 decimal places
fticr_meta
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read_excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
View(fticr_meta)
fticr_meta$Mass
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read.excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
#   adsorptive fractionation of SOM
#   Kaizad Patel
----------------------
----------------------
source("0-packages.R")
#   adsorptive fractionation of SOM
#   Kaizad Patel
----------------------
----------------------
source("0-packages.R")
#   adsorptive fractionation of SOM
#   Kaizad Patel
----------------------
----------------------
source("0-packages.R")
#   adsorptive fractionation of SOM
#   Kaizad Patel
----------------------
----------------------
source("0-packages.R")
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read.excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read_excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
# remove sample data columns. All sample names are Pre-xxx or Post-xxx
# remove unnamed columns 39-40-41
fticr_meta %>%
select(-starts_with("Pre")) %>%
select(-starts_with("Post")) %>%
select(-c("...39","...40","...41")) %>%
select(-c("C13", "Candidates","outlier")) %>%
mutate(Mass = round(Mass,4))-> # round this to 4 decimal places
fticr_meta
View(fticr_meta)
# create a new column for NOSC
fticr_meta %>%
mutate(NOSC = 4 - (((4*C) + H - (3*N) - (2*O) - (2*S))/C)) %>%
dplyr::rename(HC = H.C) %>%
dplyr:: rename(OC = O.C)->
fticr_meta
# create a smaller meta file for only HC OC
fticr_meta %>%
select(Mass, HC, OC) ->
fticr_meta_hcoc
write_csv(fticr_meta_hcoc, path = "fticr/fticr_meta_hcoc.csv")
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read_excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
# remove sample data columns. All sample names are Pre-xxx or Post-xxx
# remove unnamed columns 39-40-41
fticr_meta %>%
select(-starts_with("Pre")) %>%
select(-starts_with("Post")) %>%
select(-c("...39","...40","...41")) %>%
select(-c("C13", "Candidates","outlier")) -> # round this to 4 decimal places
fticr_meta
fticr_meta$Mass = round(fticr_meta$Mass,4)
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read_excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
# remove sample data columns. All sample names are Pre-xxx or Post-xxx
# remove unnamed columns 39-40-41
fticr_meta %>%
select(-starts_with("Pre")) %>%
select(-starts_with("Post")) %>%
select(-c("...39","...40","...41")) %>%
select(-c("C13", "Candidates","outlier")) -> # round this to 4 decimal places
fticr_meta
# create a new column for NOSC
fticr_meta %>%
mutate(NOSC = 4 - (((4*C) + H - (3*N) - (2*O) - (2*S))/C)) %>%
dplyr::rename(HC = H.C) %>%
dplyr:: rename(OC = O.C)->
fticr_meta
# create a smaller meta file for only HC OC
fticr_meta %>%
select(Mass, HC, OC) ->
fticr_meta_hcoc
write_csv(fticr_meta_hcoc, path = "fticr/fticr_meta_hcoc.csv")
# 1. load files ---------------------- ####
## 1.1 create metadata file ----
# importing full data file
fticr_meta = read_excel("Master-Formularity-reprocessing V2.xlsx", sheet = "RAW")
# remove sample data columns. All sample names are Pre-xxx or Post-xxx
# remove unnamed columns 39-40-41
fticr_meta %>%
select(-starts_with("Pre")) %>%
select(-starts_with("Post")) %>%
select(-c("...39","...40","...41")) %>%
select(-c("C13", "Candidates","outlier")) %>%
mutate(Mass = round(Mass,4))-> # round this to 4 decimal places
fticr_meta
# create a new column for NOSC
fticr_meta %>%
mutate(NOSC = 4 - (((4*C) + H - (3*N) - (2*O) - (2*S))/C)) %>%
dplyr::rename(HC = H.C) %>%
dplyr:: rename(OC = O.C)->
fticr_meta
# create a smaller meta file for only HC OC
fticr_meta %>%
select(Mass, HC, OC) ->
fticr_meta_hcoc
write_csv(fticr_meta_hcoc, path = "fticr/fticr_meta_hcoc.csv")
fticr_data_fenton = read_csv("fticr/fticr_data_fenton.csv",
col_types = cols(
Mass = col_number(),
Forest = col_factor(),
PreFenton = col_number(),
PostFenton = col_number(),
loss = col_factor()))
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = merge(fticr_data_fenton, fticr_meta_subset,by = "Mass")
# create a subset of META for only relevant columns
fticr_meta %>%
select(Mass, HC, OC,
NOSC,
Class,
KM_CH2, KMD_CH2,
AI_0)->
fticr_meta_subset
View(fticr_meta_subset)
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = merge(fticr_data_fenton, fticr_meta_subset,by = "Mass")
View(fticr_data_fenton2)
View(fticr_data_fenton)
View(fticr_data_fenton2)
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = merge(fticr_data_fenton, fticr_meta_subset,by = "Mass", all.x = T)
View(fticr_data_fenton2)
View(fticr_meta_subset)
source("0-packages.R")
fticr_data_fenton = read_csv("fticr/fticr_data_fenton.csv",
col_types = cols(
Mass = col_number(),
Forest = col_factor(),
PreFenton = col_number(),
PostFenton = col_number(),
loss = col_factor()))
fticr_data_goethite = read.csv("fticr/fticr_data_goethite.csv")
fticr_data_2 = read.csv("fticr/fticr_data_master.csv")
fticr_meta_subset = read_csv("fticr/fticr_meta_subset.csv",
col_types = cols(
Mass = col_number(),
HC = col_number(),
OC = col_number(),
NOSC = col_number(),
Class = col_factor(),
KM_CH2 = col_number(),
KMD_CH2 = col_number(),
AI_0 = col_number()
))
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = merge(fticr_data_fenton, fticr_meta_subset,by = "Mass", all.x = T)
View(fticr_data_fenton2)
fticr_data_goethite = merge(fticr_meta_subset,fticr_data_goethite, by="Mass")
View(fticr_data_goethite)
fticr_data_goethite = read.csv("fticr/fticr_data_goethite.csv")
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass")
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_data_goethite2)
fticr_data_goethite = read_csv("fticr/fticr_data_goethite.csv")
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_data_goethite2)
# merge files with the meta for van krevelen plots
fticr_data_fenton2 = merge(fticr_data_fenton, fticr_meta_subset,by = "Mass", all.x = T)
View(fticr_data_fenton2)
fticr_data_goethite = read_csv("fticr/fticr_data_goethite.csv",
col_types = cols(
Mass = col_number(),
Forest = col_factor(),
Fenton = col_factor(),
PreGoethite = col_number(),
PostGoethite = col_number(),
adsorbed = col_factor(),
new = col_factor()))
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_data_goethite2)
View(fticr_data_goethite)
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all = T)
View(fticr_data_goethite2)
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_meta_subset)
View(fticr_data_goethite2)
fticr_data_2 = read.csv("fticr/fticr_data_master.csv")
fticr_data_22 = merge(fticr_meta_subset,fticr_data_2)
View(fticr_data_22)
fticr_data_22 = merge(fticr_data_2,fticr_meta_subset)
View(fticr_data_22)
fticr_data_22 = merge(fticr_data_2,fticr_meta_subset, by="Mass")
fticr_data_22 = merge(fticr_data_2,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_data_22)
fticr_meta_hcoc=read_csv("fticr/fticr_meta_hcoc.csv")
fticr_data_22 = merge(fticr_data_2,fticr_meta_hcoc, by="Mass", all.x = T)
View(fticr_data_22)
View(fticr_meta_subset)
fticr_meta_subset = as.data.frame(fticr_meta_subset)
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_data_goethite2)
fticr_data_goethite = as.data.frame(fticr_data_goethite)
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_data_goethite2)
View(fticr_meta_subset)
View(fticr_meta_hcoc)
View(fticr_meta_subset)
View(fticr_data_goethite2)
fticr_data_goethite$Mass = round(fticr_data_goethite$Mass,4)
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_data_goethite2)
fticr_meta_subset$Mass = round(fticr_meta_subset$Mass,4)
fticr_data_goethite2 = merge(fticr_data_goethite,fticr_meta_subset, by="Mass", all.x = T)
View(fticr_data_goethite2)
